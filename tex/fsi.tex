\section{Final state interactions}

\begin{slide}[toc=FSI]{Final state interactions}
\null\vfill

  FSI describe the propagation of particles created in a primary neutrino interaction through nucleus
  
  \sep\sep

  \centering\scalebox{0.4}{\input{figures/fsi}}

  \sep
  
  All MC generators (but GIBUU) use intranuclear cascade model

\vfill\null
\end{slide}

\begin{slide}[toc=Intranuclear cascade]{Intranuclear cascade}
\null\vfill

\rput(0.74\slidewidth, 0.25\slideheight){\input{figures/cascade}}

 \begin{itemize}

  \item In INC model particles \\ are assumed to be classical \\ and move along \\ the straight line.
  \item The probability of passing \\ a distance $\lambda$ (small enough to assume constant nuclear density) without any interaction is given by:
    
  $$P(\lambda) = e^{-\lambda/\tilde\lambda}$$ 
    
 \end{itemize}

 \begin{itemize}
  \item[$\tilde\lambda$] = $(\sigma\rho)^{-1}$ - mean free path
  \item[$\sigma$]- cross section
  \item[$\rho$]- nuclear density
 \end{itemize}
 
 \psframe[linewidth = 0.02, linecolor = pdcolor1](5.5,0.5)(9.5,2)
 \rput[c](7.5,1.5){\color{pdcolor1} Can be easily handled}
 \rput[c](7.5,1){\color{pdcolor1} with MC methods.}


\vfill\null
\end{slide}

\begin{wideslide}[toc=Cascade algorithm]{The algorithm for intranuclear cascade}

  \rput(0.8\slidewidth, -0.3\slideheight)
  {
  \begin{pspicture}
  
    \onslide*{1-8}
    {
    \psframe[linewidth = 0.025, linecolor = pdcolor1](0,6)(3,7.5)
    \rput[c](1.5,7){\color{pdcolor1}\footnotesize Calculate:}
    \rput[c](1.5,6.5){\color{pdcolor1}\footnotesize $\tilde\lambda(r) = \left[\sigma\rho(r)\right]^{-1}$}
    }
    \onslide*{2-8}
    {
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(3,6.75)(3.5,6.75)
    \psframe[linewidth = 0.025, linecolor = pdcolor1](3.5,6)(6.5,7.5)
    \rput[c](5,7){\color{pdcolor1}\footnotesize $\lambda = \tilde\lambda\cdot\ln(P)$}
    \rput[c](5,6.5){\color{pdcolor1}\footnotesize $P = \mbox{rand}[0,1]$}
    }
    \onslide*{3-8}
    {
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(5,6)(5,5.5)
    \psframe[linewidth = 0.025, linecolor = pdcolor1](3.5,4)(6.5,5.5)
    \rput[c](5,5){\color{pdcolor1}\footnotesize move particle by}
    \rput[c](5,4.5){\color{pdcolor1}\footnotesize $\mbox{min}(\lambda,\lambda_{max})$}
    }
    \onslide*{4-8}
    {
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(3.5,4.75)(3,4.75)
    \psframe[linewidth = 0.025, linecolor = pdcolor1](0,4)(3,5.5)
    \rput[c](1.5,5){\color{pdcolor1}\footnotesize Check $r' > R$}
    \rput[c](1.5,4.5){\color{pdcolor1}\footnotesize $R$ - nucleus radius}
    }
    \onslide*{5-8}
    {
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(1.5,4)(1.5,3.5)
    \rput[l](1.6,3.75){\color{pdcolor1}\footnotesize Yes}
    \psframe[linewidth = 0.025, linecolor = pdcolor1](0,2)(3,3.5)
    \rput[c](1.5,3){\color{pdcolor1}\footnotesize The particle}
    \rput[c](1.5,2.5){\color{pdcolor1}\footnotesize leaves nucleus.}
    }
    \onslide*{6-8}
    {
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(3,4)(3.5,3.5)
    \rput[l](3.25,3.85){\color{pdcolor1}\footnotesize No}
    \psframe[linewidth = 0.025, linecolor = pdcolor1](3.5,2)(6.5,3.5)
    \rput[c](5,3){\color{pdcolor1}\footnotesize Check}
    \rput[c](5,2.5){\color{pdcolor1}\footnotesize $\lambda < \lambda_{max}$.}
    \psline[linewidth = 0.025, linecolor = pdcolor1](6.5,2.75)(7,2.75)
    \psline[linewidth = 0.025, linecolor = pdcolor1](7,2.75)(7,8)
    \psline[linewidth = 0.025, linecolor = pdcolor1](7,8)(1.5,8)
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(1.5,8)(1.5,7.5)
    \rput[l](6.6,2.6){\color{pdcolor1}\footnotesize No}
    }
    \onslide*{7-8}
    {
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(5,2)(5,1.5)
    \rput[l](5.1,1.75){\color{pdcolor1}\footnotesize Yes}
    \psframe[linewidth = 0.025, linecolor = pdcolor1](3.5,0)(6.5,1.5)   
    \rput[c](5,1){\color{pdcolor1}\footnotesize Generate}
    \rput[c](5,0.5){\color{pdcolor1}\footnotesize the interaction.}
    }
    \onslide*{8}
    {
    \psframe[linewidth = 0.025, linecolor = pdcolor1](0,0)(3,1.5)
    \rput[c](1.5,1){\color{pdcolor1}\footnotesize Check}
    \rput[c](1.5,0.5){\color{pdcolor1}\footnotesize Pauli blocking.}
    
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(3.5,0.75)(3,0.75)
    
    \psline[linewidth = 0.025, linecolor = pdcolor1](0,0.75)(-0.5,0.75)
    \psline[linewidth = 0.025, linecolor = pdcolor1](-0.5,0.75)(-0.5,6.75)
    \psline[linewidth = 0.025, linecolor = pdcolor1]{->}(-0.5,6.75)(0,6.75)    
    }
    
  \end{pspicture}
  }
  
  \rput(0.55\slidewidth, 0.1\slideheight)
  {
  \begin{pspicture}
  
    \onslide*{1-8}
    {
    \pscircle[linewidth = 0.05, linecolor = pdcolor1](0,0){2}

    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor1](0.75,1){0.2}
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor1](-0.5,1.25){0.2}
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor1](-1,0){0.2}
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor1](0,0.45){0.2}
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor1](0.6, -0.75){0.2}
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor1](-0.4, -1.2){0.2}
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor1](1.25, 0){0.2}
    }

    \onslide*{1-2}
    {
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor4](-0.6,-0.6){0.2}
    }

    \onslide*{1}
    {
    \psline[linewidth = 0.02, linecolor = pdcolor1]{<->}(0,0)(-0.4,-0.4)
    \rput[c]{45}(-0.25,-0.1){\color{pdcolor1}\footnotesize $r$}
    }

    \onslide*{7}
    {
    \psline[linewidth = 0.02, linecolor = pdcolor3]{|<->|}(-0.38,-0.73)(1,-0.1)    
    \rput[c]{25}(0.2,-0.6){\color{pdcolor3}\tiny $x_{max}$}
    }
    
    \onslide*{7-8}
    {
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor5](0.8,0.15){0.2}    
    \psline[linewidth = 0.02, linecolor = pdcolor5]{->}(1,0.275)(1.2,0.375)
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor1](0.5,0.15){0.2}    
    \psline[linewidth = 0.02, linecolor = pdcolor1]{->}(0.5,0.375)(0.5,0.575)
    }
    
    \onslide*{8}
    {
    \psline[linewidth = 0.02, linecolor = pdcolor1]{->}(0.75, 1.225)(0.75, 1.435)
    \pscircle[linewidth = 0.01, linecolor = pdcolor4](0.75, 1.325){0.125}
    \pscircle[linewidth = 0.01, linecolor = pdcolor4](0.5, 0.475){0.125}
    }
    
    \onslide*{2-4,6-8}
    {
    \psline[linewidth = 0.02, linecolor = pdcolor4]{->}(-0.4,-0.55)(0.4,-0.2)
    }
    
    \onslide*{3-4,6-8}
    {
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor4,opacity = 0.5](-0.6,-0.6){0.2}
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor4](0.6,-0.1){0.2}
    }
    
    \onslide*{4}
    {
    \psline[linewidth = 0.02, linecolor = pdcolor1]{<->}(0,0)(0.4,-0.1)
    \rput[c]{-10}(0.3,0.1){\color{pdcolor1}\footnotesize $r'$}
    }

    \onslide*{5}
    {
    \psline[linewidth = 0.02, linecolor = pdcolor4]{->}(-0.8,-0.675)(-1.8,-1.2)
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor4,opacity = 0.5](-0.6,-0.6){0.2}
    \pscircle[linestyle = none, fillstyle = solid, fillcolor = pdcolor4](-2,-1.3){0.2}
    }
    
    \onslide*{6}
    {
    \psline[linewidth = 0.02, linecolor = pdcolor3]{|<->|}(-0.38,-0.73)(0.3,-0.425)    
    \rput[c]{25}(0,-0.7){\color{pdcolor3}\tiny $x_{max}$}
    }
    
  \end{pspicture}
  }

\end{wideslide}

\begin{slide}{INC input}
\null\vfill

  \begin{itemize}
  
    \item The main input to the INC model is the particle-nucleon cross section
    \item Total cross section affects the mean free path
    \item Ratios of cross sections
    
    \sep
    
    $$\frac{\sigma_{qel}}{\sigma_{total}}, \hspace{10pt}\frac{\sigma_{cex}}{\sigma_{total}}, \hspace{10pt}\frac{\sigma_{abs}}{\sigma_{total}}, \hspace{10pt}...$$

    \sep
    
    are used to determine what kind of scattering happened
    
    \item NuWro and Neut use Oset model for low-energy pions and data-driven cross sections for all other cases
    
    \item GENIE has two models of FSI
        
  \end{itemize}

\vfill\null
\end{slide}

\begin{slide}{FSI in GENIE}
\null\vfill

  \centering\input{figures/intranuke}
  
  \sep\sep
  
  \twocolumn
  {
    \begin{itemize}
     \item intranuclear cascade
     \item data-driven cross sections
     \item Oset model for pions (coming soon)
    \end{itemize}
  }
  {
    \begin{itemize}
     \item INC-like with one ``effective'' interaction
     \item tuned do hadron-nucleus data
     \item easy to reweight 
    \end{itemize}
  }

\vfill\null
\end{slide}